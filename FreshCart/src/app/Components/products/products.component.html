<section class="container py-5" *ngIf="products.length > 0">
  <h2 class="fw-bold text-center mb-5">
    <i class="fa-solid fa-bag-shopping me-2 style=color:#3D3641;"></i> All Products
  </h2>

  <!-- Search -->
  <input 
    type="text" 
    class="form-control w-50 mx-auto form-control-sm mb-5 rounded-pill shadow-sm" 
    placeholder="Search all products..." 
    [(ngModel)]="term">

  <!-- Product Grid -->
  <div class="row g-4">
    <div *ngFor="let product of products | search:term  | paginate: { id: 'productPaginate',
        itemsPerPage: pageSize,
        currentPage: currentPage,
        totalItems: total }" 
        class="col-sm-6 col-md-4 col-lg-3 col-xl-2">

      <!-- Product Card -->
      <div class="card h-100 shadow-sm border-0 rounded-4 position-relative overflow-hidden product-card"
           style="transition: transform 0.2s;">

        <!-- Product Info -->
        <div class="card-body d-flex flex-column text-center p-3">
          <a [routerLink]="['/productDetails',product._id]" class="text-decoration-none text-dark">
            <img class="mx-auto mb-3" style="height: 180px; object-fit: contain;" 
                 [src]="product.imageCover" [title]="product.title" [alt]="product.title">

            <h3 class="h6 fw-bold">{{product.title | cuttext:3}}</h3>
            <h4 class="small text-muted">{{product.category.name}}</h4>
          </a>

          <!-- Price + Rating -->
          <div class="mt-auto">
            <div class="d-flex align-items-center justify-content-between mt-2">
              <span class="fw-bold text-success">{{product.price | currency:' EGP '}}</span>
              <p class="mb-0 small text-warning">
                <i [class.rating-color]="product.ratingsAverage >= num" 
                   *ngFor="let num of [1,2,3,4,5]" 
                   class="fas fa-star"></i>
                <span class="ms-1">{{product.ratingsAverage}}</span>
              </p>
            </div>
          </div>
        </div>

        <!-- Add to Cart -->
        <footer class="p-3 text-center add-to-cart-btn"
                style="opacity:0; transition: opacity 0.3s;">
          <button (click)="addProduct(product._id, btnAdd)" #btnAdd 
                  class="btn btn-sm rounded-pill text-white px-3" 
                  style="background-color: #8C6E63;">
            <i class="fa-solid fa-cart-arrow-down me-2"></i> Add To Cart
          </button>
        </footer>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="d-flex justify-content-center mt-5">
    <pagination-controls  
      id="productPaginate"
      (pageChange)="pageChanged($event)"
      (pageBoundsCorrection)="pageChanged($event)"
      [maxSize]="9"
      [directionLinks]="true"
      [autoHide]="true"
      [responsive]="true"
      previousLabel="« Previous"
      nextLabel="Next »"
      screenReaderPaginationLabel="Pagination"
      screenReaderPageLabel="page"
      screenReaderCurrentLabel="You're on page">
    </pagination-controls>
  </div>
</section>
<style>
  .product-card:hover {
    transform: translateY(-5px);
  }
  .product-card:hover .add-to-cart-btn {
    opacity: 1 !important;
  }
  .product-card {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .ngx-pagination {
    font-size: 0.9rem;
  }
  .ngx-pagination .current {
    background-color: #8C6E63 !important;
    border-radius: 50px;
    color: #fff !important;
    padding: 0.4rem 0.8rem;
  }
</style>
